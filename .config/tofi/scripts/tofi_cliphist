#!/usr/bin/env bash
# https://github.com/bitterhalt
# Note: Yes you see numbers before results :(
# Read: https://github.com/sentriz/cliphist#faq and https://github.com/philj56/tofi/issues/102

set -e

list () {
    cliphist list | tofi  --text-cursor false \
        --font-size 12 \
        --prompt-text "Search:" \
        --padding-top  10 \
        --width 40% \
        --height 40% \
        --anchor center \
        --corner-radius 0 \
        --border-width 1 | \
        cliphist decode | wl-copy
    }

    wipe () {
        answer="$(echo -e "Yes\nNo" |
            tofi  --prompt-text "Delete Clipboard?" \
            --height   12% \
            --border-width  2 \
            --outline-width  0 \
            --padding-left  20)"

        if [[ $answer == "Yes" ]]; then
            rm $XDG_CACHE_HOME/cliphist/db
            notify-send "Clipboard database deleted!"
        fi
        exit 0
    }

    case "$1" in 
        "-l")
            list
            ;;
        "-w")
            wipe
            ;;
        *)
            echo "Invalid argument"
            exit 1
            ;;
    esac
